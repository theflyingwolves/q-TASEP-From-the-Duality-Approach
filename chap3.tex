\chapter{Fredholm Determinants}
In last chapter, we have derived a nested contour integral expression for $\mathbb{E}[\prod_{j=1}^k q^{x_{n_j}+n_j}]$ using some ODE systems. In this chapter we introduce Fredholm Determinants and try to transform the nested contour integrals into the form of a Fredholm determinants. However, from now onwards, we will only be focusing on the distribution of a single particle $x_n(t)$, since the joint distribution of an arbitrary collection of particles $x_{n_1}(t), \dots, x_{n_l}(t)$ will involve some further complexities that will bring challenges into getting a relatively simple expression. To do this, we apply Corollary \ref{nested-contour-corollary} with $\vec{n} = (n,n,\dots, n)$, which results in $\mathbb{E}[\prod_{j=1}^k q^{x_{n_j}+n_j}] = q^{kn} \mathbb{E} [q^{kx_n(t)}]$. 

\section{Fredholm Determinants}
We begin by quoting the definition of a Fredholm determinant from Definition 3.2.6 in \cite{macdonald2014}.

\begin{definition}
Fix a Hilbert space $L^2(X,\mu)$ where $X$ is a measurable space and $\mu$ is a measure on $X$. When $X = \Gamma$, a simple smooth contour in $\mathbb{C}$, we write $L^2(\Gamma)$ where $\mu$ is understood to be the path measure along $\Gamma$ divided by $2 \pi i$. When $X$ is the product of a discrete set $D$ and a contour $\Gamma$, $\mu$ is understood to be the product of the counting measure on $D$ and the path measure along $\Gamma$ divided by $2 \pi i$.
Let K be an integral operator acting on $f(\cdot) \in L^2(X,\mu)$ by $$(Kf)(x) = \int_X K(x,y) f(y) d\mu(y).$$ $K(x,y)$ is called the kernel of $K$. A formal Fredholm determinant expansion of $I+K$ is a formal series written as $$det(I+K) = 1 + \sum_{n=1}^{\infty} \frac{1}{n!} \int_X \dots \int_X det[K(x_i,x_j)]_{i,j=1}^{n} \prod_{i=1}^{n} d\mu(x_i)$$
If the above series is absolutely convergent, then we call this a numerical Fredholm determinant expansion.
\end{definition}

In order to transform a nested contour integrals of similar forms to the ones given in Theorem \ref{thm:nested-contour-integration}, the idea is to deform the nested contours so that they coincide. However, there are two types of deformation, namely the Mellin-Barnes type and the Cauchy type. The philosophy for the Mellin-Barnes type approach is to deform the contours in such a way that all of the poles corresponding to $z_A = qz_B$ for $A < B$ are encountered. This is, in some sense, shrinking the contours so that they coincide. The Cauchy type approach does the opporsite that it enlarges the contours so that they coincide. Poles at $z_k = 0$ are encountered in this process.

In the following sections, we introduce the two approaches in details and see how each of them can be applied to q-TASEP. But before that, we first identify the exact form of nested contours to be manipulated by Definition 3.1 in \cite{macdonald2014}.

\begin{definition}
\label{mu_k_def}
For a meromorphic function $f(z)$ and $k \ge 1$ set $\mathbb{A}$ to be a fixed set of poles of $f$ (not including 0) and assume that $q^m \mathbb{A}$ is disjoint from $\mathbb{A}$ for all $m \ge 1$. Define
$$\mu_k = \frac{(-1)^k q^{k(k-1)/2}}{(2 \pi i)^k} \int \dots \int \prod_{1 \le A < B \le k} \frac{z_A - z_B} {z_A - qz_B} \prod_{i=1}^k f(z_i) \frac{dz_i}{z_i},$$ where the integration contour for $z_A$ contains $\{qz_B\}_{B > A}$, the fixed set of poles $\mathbb{A}$ of $f(z)$ but not $0$ or any other poles. 
\end{definition}

Notice that when we take $f(z) = \left( \prod_{m=1}^{n} \frac{a_m}{a_m - z} \right) e^{(q-1)tz}$, $u(t;\vec{n})$ for step initial data in Theorem \ref{thm:nested-contour-integration} is recovered.

\section{Mellin-Barnes type determinants}

\subsection{Mellin-Barnes type transformation}
\label{m-b-type-transformation}
First, we introduce some notations used. For $\lambda = (\lambda_1 \ge \lambda_2 \ge \dots \ge 0)$, we write $\lambda \vdash k$ if $\sum_i \lambda_i = k$ and $\lambda = 1^{m_1} 2^{m_2} \dots$ if $i$ appears $m_i$ times in $\lambda$. Let $l(\lambda) = \sum_i m_i$ denote the number of non-zero elements of $\lambda$.\\
In Mellin-Barnes type determinants, the nested contours are deformed to coincide so that the only poles encountered are at $z_A = qz_B$ for $A < B$. With this philosophy, we transform the $\mu_k$ as defined in Definition \ref{mu_k_def} into the following form with the contours shrinked to coincide. The result is given in the following proposition.
\begin{proposition}
\label{mellin-barnes-transform}
Define
\begin{align*}
\gamma_k &= k_q! \sum_{\substack{{\lambda \vdash k}\\ {\lambda = 1^{m_1} 2^{m_2} \dots}}} \frac{1}{m_1! m_2! \dots} \frac{(1-q)^k}{(2 \pi i)^{l(\lambda)}} \\
			& \quad \times \int \dots \int det\left[ \frac{1}{w_iq^{\lambda_i} - w_j} \right]_{i,j=1}^{l(\lambda)} \times \prod_{j=1}^{l(\lambda)} f(w_j) f(qw_j) \dots f(q^{\lambda_j-1} w_j) dw_j \numberthis \label{new_mu_k}
\end{align*}
where the $w_j$ contours contain the same fixed set of singularities $\mathbb{A}$ of $f(z)$ but no other poles and $k_q! = \prod_{i=1}^{k} \frac{1-q^i}{1-q}$. Then for all $k \in \mathbb{Z} = \frac{(q;q)_k}{(1-q)^k}$,
$$\gamma_k = \mu_k$$
\end{proposition}

\begin{remark}
Note that in $\gamma_k$ the contours have been deformed to coincide with each other containing the same fixed set of singularities. 
\end{remark}

Before moving on to the proof, we discuss a transformation of the RHS of Equation \ref{mellin-barnes-transform}. \\
In $\gamma_k$, in order to evaluate the integral, for each $\lambda \vdash k$, we have to sum over all possible combination of $l(\lambda)$ poles chosen from the fixed set $\mathbb{A}$ of poles of $f(z)$. Because of the determinant, zero contribution would occur if identical poles were chosen for different variable $w_i \neq w_j$ since it would result in two identical columns in the determinant. Therefore, when considering a set of $l(\lambda)$ poles, we will make sure that the poles chosen are mutually distinct.

Moreover, for a particular $\lambda$ with some $\lambda_i = \lambda_j$ for $i \neq j$, interchanging $\lambda_i$ and $\lambda_j$ will not affect the evaluation. This allows us to cancel away the prefactor of $\frac{1}{m_1! m_2! \dots}$. Hence, we can replace the summation over $\lambda$ in Equation \ref{mellin-barnes-transform} by a summation over disjoint subsets of $\mathit{J}$ of size $m_1$, $m_2$, etc, where $m_1 + 2m_2 + \dots = k$. Denote these subsets by $S_1, S_2, \dots$ respectively and write $S = (S_1, S_2, \dots ) = (b_1, \dots, b_{m_1}, b_{m_1+1}, \dots, b_{m_1 + m_2}, \dots)$, where $b_i \in S_1$ for $1 \le i \le m_1$, $b_i \in S_2$ for $m_1 < i \le m_2$ and so on. Denote the set of all such collections of subsets $S's$ to be $\mathcal{S}$. Then by evaluating the corresponding residues Equation \ref{mellin-barnes-transform} can be transformed to
\begin{equation}
\gamma_k = \sum_{S \in \mathcal{S}} k_q! (1-q)^k \prod_{j=1}^{m_1+m_2+\dots} Res_{w=b_j} f(w) f(qb_j) \dots f(q^{\lambda(b_j)} b_j) det\left[ \frac{1}{b_iq^{\lambda(b_i)} - b_j} \right]_{i,j=1}^{m_1+m_2+\dots}
\end{equation}

To illustrate what has been discussed above, we take $k = 4$ for an example. In this case, all possible $\lambda 's$ are $(4,0), (3,1), (2,2), (2,1,1), (1,1,1,1)$. Take $\lambda = (2,1,1')$ (In $1'$ the superscript is to differentiate it from the previous $1$) and we get $m_1 = 2$, $m_2 = 1$, $m_i = 0$ for $i \ge 3$ and $l(\lambda) = 3$. Therefore, $|S_1| = m_1 = 2$ and $|S_2| = m_2 = 1$. One possible collection of such $S_i's$ is $S_1 = \{1,1'\}$ and $S_2 = \{2\}$ and hence $S = (\{1,1'\},  \{2\})$. Therefore, for this particular $k = 3$ and $\lambda$, all possible collections of such $S's$ are 
\begin{align}
\mathcal{S}_{\lambda} = \{ &(\{1,1'\},\{2\}), (\{1,2\},\{1'\}), \\ 
													 &(\{1',1\},\{2\}), (\{1', 2\},\{1\}),\\
													 &(\{2,1\},\{1'\}), (\{2,1'\},\{1\})\}
\end{align}
Notice that the sets $S's$ are ordered sets since they corresponds to poles of different $w_j's$. Also, notice that interchanging $1$ and $1'$ results in equal contributions. Therefore, the prefactor $\frac{1}{m_1! m_2! \dots} = \frac{1}{2}$ is needed to account for this effect.

\begin{proof}[Proof of Proposition \ref{mellin-barnes-transform}]
The proof is by induction on $k$. For $k=1$, by definition, 
$$\mu_1 = - \frac{1}{2 \pi i} \int f(z_1) \frac{dz_1}{z_1}.$$ Moreover, the only $\lambda$ is $\lambda = (1,0)$ and $\gamma_k$ reduces to $$\frac{1-q}{2 \pi i} \int \frac{1}{q w_1 - w_1 } f(w_1) dw_1 = - \frac{1}{2 \pi i} \int f(w_1) \frac{dw_1}{w_1}.$$ Comparing the two expression, we get that $\mu_1 = \gamma_1$.

For the induction step, let $k \in \mathbb{Z}_+$ and assume that $\mu_{k-1} = \gamma_{k-1}$. Let $\mathit{J}$ denote an index set of $\mathbb{A}$ $(\mathit{J} = \{1,\dots,|\mathbb{A}|\})$ and recall the definition of $\mu_k$ in Definition \ref{mu_k_def} that $$\mu_k = \frac{(-1)^k q^{k(k-1)/2}}{(2 \pi i)^k} \int \dots \int \prod_{1 \le A < B \le k} \frac{z_A - z_B} {z_A - qz_B} \prod_{i=1}^k f(z_i) \frac{dz_i}{z_i},$$ we evaluate the integral over $z_k$ using residue calculus to get
\begin{align*}
\mu_k &= (-q^{k-1}) \sum_{j \in \mathit{J}} \frac{Res_{z = a_j} f(z)}{a_j} (-1)^{k-1} \frac{q^{(k-1)(k-2)/2}}{(2 \pi i)^{k-1}} \\
& \quad \times \int \dots \int \prod_{1 \le A < B \le k-1} \frac{z_A - z_B}{z_A - qz_B} \prod_{i=1}^{k-1} \frac{z_i - a_j}{z_i - qa_j} \frac{f(z_i)}{z_i} dz_i. \numberthis \label{induction-mu}
\end{align*}
Notice that the integral on the right hand side of Equation \ref{induction-mu} is an $k-1$ fold nested contour integral, to which we can apply, for each $j$, our induction assumption with $\tilde{f}_j(z) = f(z) \frac{z-a_j}{z-qa_j}$ and the new sets of poles $\tilde{\mathbb{A}}_j = (\mathbb{A} \setminus \{a_j\}) \cup \{qa_j\}$. The resulting form is 
\begin{align*}
\mu_k &= (-q^{k-1}) \sum_{j \in \mathit{J}} \frac{Res_{z = a_j} f(z)}{a_j} \times (k-1)_q! \sum_{\substack{{\lambda \vdash k-1}\\ {\lambda = 1^{\tilde{m}_1} 2^{\tilde{m}_2} \dots}}} \frac{1}{\tilde{m}_1! \tilde{m}_2! \dots} \frac{(1-q)^{k-1}}{(2 \pi i)^{l(\lambda)}} \\
			& \quad \times \int \dots \int det\left[ \frac{1}{w_iq^{\lambda_i} - w_j} \right]_{i,j=1}^{l(\lambda)} \times \prod_{t=1}^{l(\lambda)} \tilde{f}_j(w_t) \tilde{f}_j(qw_t) \dots \tilde{f}_j(q^{\lambda_t-1} w_t) dw_t \numberthis \label{mu-form-2}
\end{align*}

From the transformation discussed just before the proof, we can see that (\ref{mu-form-2}) can be transformed to 
\begin{align*}
%\mu_k &= (-q^{k-1}) (k-1)_q! (1-q)^{k-1} \sum_{j \in \mathit{J}} \sum_{\tilde{S} \in \tilde{\mathcal{S}}_j} \frac{1}{a_j}  det\left[ \frac{1}{ \tilde{b}_i q^{\tilde{\lambda}(\tilde{b}_i)} - \tilde{b}_l } \right]_{\tilde{b}_i, \tilde{b}_l \in \tilde{S}}\\
%& \quad \times \prod_{\tilde{b} \in \tilde{S} \setminus \{qa_j\}} Res_{w = \tilde{b}} \tilde{f}_j(w) \tilde{f}_j(q\tilde{b}) \dots \tilde{f}_j(q^{\tilde{\lambda}(\tilde{b}) - 1} \tilde{b}) \\
%& \quad \times Res_{w = a_j} f(w) \times Res_{w = qa_j} \tilde{f}_j(w) \tilde{f}_j(q^2 a_j) \dots \tilde{f}_j(q^{\tilde{\lambda}(qa_j)} a_j) \numberthis \label{mu-form-3}
\mu_k &= (-q^{k-1}) (k-1)_q! (1-q)^{k-1} \sum_{j \in \mathit{J}} \sum_{\tilde{S} \in \tilde{\mathcal{S}}_j} \frac{1}{a_j}  det\left[ \frac{1}{ \tilde{b}_i q^{\tilde{\lambda}(\tilde{b}_i)} - \tilde{b}_l } \right]_{\tilde{b}_i, \tilde{b}_l \in \tilde{S}}\\
& \quad \times Res(\tilde{S}) \times Res_{w = a_j} f(w), \numberthis \label{mu-form-3}
\end{align*}
where for $\tilde{S}$ such that $qa_j \in \tilde{S}$,
\begin{align*}
Res(\tilde{S}) &= \prod_{\tilde{b} \in \tilde{S} \setminus \{qa_j\}} Res_{w = \tilde{b}} \tilde{f}_j(w) \tilde{f}_j(q\tilde{b}) \dots \tilde{f}_j(q^{\tilde{\lambda}(\tilde{b}) - 1} \tilde{b}) \\
& \quad \times Res_{w = qa_j} \tilde{f}_j(w) \tilde{f}_j(q^2 a_j) \dots \tilde{f}_j(q^{\tilde{\lambda}(qa_j)} a_j) \numberthis \label{mu-form-sub-3}
\end{align*}
and otherwise
$$Res(\tilde{S}) = \prod_{\tilde{b} \in \tilde{S}} Res_{w = \tilde{b}} \tilde{f}_j(w) \tilde{f}_j(q\tilde{b}) \dots \tilde{f}_j(q^{\tilde{\lambda}(\tilde{b}) - 1} \tilde{b}),
$$
where $\tilde{\mathcal{S}}_j$ denotes the set of all collections $\tilde{S}$ of subsets $\tilde{S}_{j,1}, \tilde{S}_{j,2}, \dots$ of $\tilde{\mathbb{A}}_j$, where $\tilde{S}_{j,k}$ is of size $\tilde{m}_k$ and $\tilde{m}_1 + 2\tilde{m}_2 + \dots = k-1$. Also, we reorder the elements in $\tilde{S}$ to be $\tilde{S} = (\tilde{b}_1, \tilde{b}_2, \dots, \tilde{b}_{\tilde{m}_1}, \dots)$ so that the first $\tilde{m}_1$ elements belong to $\tilde{S}_{j,1}$ etc.\\ \\
Note that for $\tilde{b} \neq a_j$ such that $\tilde{\lambda}(\tilde{b}) = \lambda$, 
\begin{align*}
&Res_{w=\tilde{b}} \tilde{f}_j(w) \tilde{f}_j(q\tilde{b}) \dots \tilde{f}_j(q^{\lambda-1} \tilde{b}) \\
& \quad= \frac{\tilde{b} - a_j}{\tilde{b} - qa_j} \frac{q\tilde{b} - a_j}{q\tilde{b} - qa_j} \dots \frac{q^{\lambda-1} \tilde{b} - a_j}{q^{\lambda-1} \tilde{b} - qa_j} Res_{w=\tilde{b}} f(w) f(q \tilde{b}) \dots f(q^{\lambda-1}\tilde{b}) \\
& \quad=  \frac{q^{\lambda - 1} \tilde{b} - a_j}{\tilde{b} - qa_j} q^{1 - \lambda} Res_{w = \tilde{b}} f(w) f(q\tilde{b}) \dots f(q^{\lambda-1} \tilde{b}) \numberthis \label{equality-mu-1}
\end{align*}
and 
\begin{align*}
& Res_{w = qa_j} \tilde{f}_j(w) \tilde{f}_j(q^2 a_j) \dots \tilde{f}_j(q^{\tilde{\lambda}(qa_j)} a_j)\\
& \quad = (q-1)a_j \frac{q^2a_j - a_j}{q^2 a_j - qa_j} \dots \frac{q^{\tilde{\lambda}(qa_j)}a_j - a_j}{q^{\tilde{\lambda}(qa_j)} a_j - qa_j} f(qa_j) \dots f(q^{\tilde{\lambda}(qa_j)} a_j) \\
& \quad = a_j (q^{\tilde{\lambda}(qa_j)} - 1) q^{2 - \tilde{\lambda}(qa_j)} f(qa_j) \dots f(q^{\tilde{\lambda}(qa_j)} a_j) \numberthis \label{equality-mu-2}
\end{align*}
Applying (\ref{equality-mu-1})  and (\ref{equality-mu-2}) to (\ref{mu-form-sub-3}), we get for $\tilde{b} \neq a_j$ such that $\tilde{\lambda}(\tilde{b}) = \lambda$,
\begin{align*}
Res(\tilde{S}) &= \prod_{\tilde{b} \in \tilde{S} \setminus \{qa_j\}} \frac{q^{\tilde{\lambda}(\tilde{b}) - 1} \tilde{b} - a_j}{\tilde{b} - qa_j} q^{1 - \tilde{\lambda}(\tilde{b})} Res_{w = \tilde{b}} f(w) f(q\tilde{b}) \dots f(q^{\tilde{\lambda}(\tilde{b})-1} \tilde{b}) \\
& \quad \times a_j (q^{\tilde{\lambda}(qa_j)} - 1) q^{2 - \tilde{\lambda}(qa_j)} f(qa_j) \dots f(q^{\tilde{\lambda}(qa_j)} a_j) \\
&= \prod_{l \neq j} \frac{q^{\tilde{\lambda}(b_l) - 1} b_l - a_j}{b_l - qa_j} q^{1 - \tilde{\lambda}(b_l)} Res_{w = b_l} f(w) f(qb_l) \dots f(q^{\tilde{\lambda}(b_l)-1} b_l) \\
& \quad \times a_j (q^{\tilde{\lambda}(qa_j)} - 1) q^{2 - \tilde{\lambda}(qa_j)} f(qa_j) \dots f(q^{\tilde{\lambda}(qa_j)} a_j)
\numberthis \label{mu-form-4}
\end{align*}
For convenience purpose, for each $\tilde{S} = (\tilde{S}_{j,1}, \tilde{S}_{j,2}, \dots) \in \tilde{\mathcal{S}}_j$, we map it to a new set $S_j = (S_{j,1}, S_{j,2}, \dots)$ in the following manner:\\
If $qa_j \in \tilde{S}_{j,l}$  for some $l$, then $$S_{j,l} = \tilde{S}_{j,l} \setminus \{qa_j\}, S_{j,l+1} = \tilde{S}_{j,l+1} \cup \{a_j\}, S_{j,m} = \tilde{S}_{j,m} \text{ for all } m \neq l, l+1,$$
Otherwise, $$S_{j,1} = \tilde{S}_{j,1} \cup \{a_j\}, S_m = \tilde{S}_m \text{ for all } m > 1.$$
With the new set $S_j$, we can then write $Res_{w=a_j} f(w) Res(\tilde{S})$ in the following form
\begin{align*}
Res_{w=a_j} f(w) Res(\tilde{S}) &= a_j (q^{\tilde{\lambda}(qa_j)} - 1) q^{2 - \tilde{\lambda}(qa_j)} \prod_{l \neq j}  \frac{q^{\tilde{\lambda}(b_l) - 1} b_l - a_j}{b_l - qa_j} q^{1 - \tilde{\lambda}(b_l)} \\
& \quad \times \prod_{b \in S_{j,1} \cup S_{j,2} \dots} Res_{w = b} f(w) f(qb) \dots f(q^{\tilde{\lambda}(b) - 1}b) \numberthis \label{always-true-set-transform}
\end{align*}
Notice that (\ref{always-true-set-transform}) always holds regardless of whether $qa_j$ is in $\tilde{S}$, and that the union of all such $S_j$ for each $j$ is just $\mathcal{S}$ for $\gamma_k$. Therefore, $\mu_k$ in (\ref{mu-form-3}) can be re-written as
\begin{align*}
\mu_k &= \sum_{S \in \mathcal{S}} (k-1)_q! (1-q)^{k-1} (-q^{k-1})  \prod_{j = 1}^{m_1 + m_2 + \dots} Res_{w = b_j} f(w) f(qb_j) \dots f(q^{\lambda(b_j) - 1} b_j) \\
& \quad \times \sum_{j=1}^{m_1 + m_2 + \dots} (q^{\lambda(b_j) - 1} - 1) q^{2 -\lambda(b_j)} \prod_{l \neq j}  \frac{q^{\lambda(b_l) - 1} b_l - b_j}{b_l - qb_j} q^{1 - \lambda(b_l)} det \left[ \frac{1}{b_i q^{\lambda(b_i)} - b_l q^{\delta_{l,j}}} \right]_{i,l = 1}^{m_1 + m_2 + \dots},
\end{align*}
where $\delta_{l,j} = 1$ if $l = j$ and $0$ otherwise. \\
Hence, in order to complete the proof, what we need to show is $\mu_k = \gamma_k$. After tidying up the expressions, we are only left to show that for each $S \in \mathcal{S}$,
\begin{align*}
& \quad \sum_{j=1}^{m_1 + m_2 + \dots} (q - q^{\lambda_j}) \prod_{l \neq j} \frac{qb_j - q^{\lambda_l} b_l}{qb_j - b_l} det \left[ \frac{1}{b_i q^{\lambda_i} - b_l q^{\delta_{l,j}}} \right]_{i,l = 1}^{m_1 + m_2 + \dots} \\
&= (1-q^{ \sum \lambda_i }) det \left[ \frac{1}{b_i q^{\lambda_i} - b_l} \right]_{i,l = 1}^{m_1 + m_2 + \dots}, \numberthis \label{equality-to-shown-mellin}
\end{align*}
where $\lambda_i = \lambda(b_i)$. Recall the Cauchy determinant 
$$det\left[ \frac{1}{x_i + y_i} \right] = \frac{V(x_i) V(x_j)}{\prod_{i,j} (x_i + x_j)},$$ where $V(x_i) = \prod_{i<j} (x_i - x_j)$ is the Vandermonde determinant. Using the Cauchy determinant we obtain that Equation (\ref{equality-to-shown-mellin}) is equivalent to
$$ \sum_{j=1}^{m_1 + m_2 + \dots} (q - q^{\lambda_j}) \prod_{l \neq j} \frac{qb_j - q^{\lambda_l} b_l}{qb_j - b_l} \frac{V(b_i q^{\lambda_i}) V(b_l q^{\delta_{l,j}})}{\prod_{i,l} (b_l q^{\delta_{l,j}} - b_i q^{\lambda_i})} = (1-q^{ \sum \lambda_i }) \frac{V(b_i q^{\lambda_i}) V(b_l)}{\prod_{i,l} (b_l - b_i q^{\lambda_i})}$$
After cancelling out some terms, we are left with 
\begin{equation}
\label{final-equality-to-prove}
\sum_{j \ge 1} \frac{\prod_{l \ge 1} (b_j - b_l q^{\lambda_l})}{\prod_{l \neq j} (b_j - b_l)} \frac{1}{b_j} = 1 - q^{\sum \lambda_i}
\end{equation}
Take $$g(z) = \prod_{l \ge 1} \frac{z - b_l q^{\lambda_l}}{z - b_l} \frac{1}{z}.$$ Then the LHS of (\ref{final-equality-to-prove}) is just the sum of the residues of the function $g(z)$ at the points $z = b_l$ for $l \ge 1$. Moreover, notice that $Res_{z = 0} g(z) = q^{\sum \lambda_l}$ and $Res_{z = \infty} g(z) = 1$ so the RHS is just the difference of the residues of the function $g(z)$ at the point $z = \infty$ and $z = 0$. Recalling the fact that for $f$ holomorphic in $\mathbb{C}$ except for isolated singularities $a_1, \dots, a_n$, then $$Res_{z = \infty} f(z) = \sum_{k = 1}^{n} Res_{z = a_k} f(z),$$ we complete the proof.
\end{proof}

With Proposition \ref{mellin-barnes-transform}, we have successfully transformed the nested contours so that they can coincide with each other. That is, while the pervious contour for $z_A$ contains poles at $\mathbb{A}$ and $\{qz_B\}_{B>A}$, current contour for $w_A$ only contain poles at $\mathbb{A}$. Therefore, the contours for $w_i$, $i = 1, \dots, k$ can now be chosen to be the same contour, denoted as $C_{\mathbb{A}}$ that contains poles only at $\mathbb{A}$ and no other poles. 

\subsection{Transformation to Fredholm determinants}
\label{transformation-to-fd}
We introduce some contours that will be used in later propositions. First we define the contour $C_{1,2,\dots}$ to be an infinite contour negatively oriented that encloses $1,2,\dots$ and no poles of $f(q^sw)$ for all $s \in \mathbb{Z}$. One possible such contour is $\frac{1}{2} + i\mathbb{R}$ oriented from $\frac{1}{2} - i\infty$ to $\frac{1}{2} + i\infty$. 

Moreover, for any $R > 0, d > 0$, we define the contour $D_{R,d}$ to be such that it goes by straight lines from $R - i\infty$ to $R - i d$, to $1/2 - i d$, to $1/2 + id$, to $R + id$ and lastly to $R+i\infty$. With $D_{R,d}$, for any $k \in \mathbb{Z}_{>0}$, we further define the contour $D_{R,d;k}$ to be as follows: let $p, \bar{p}$ (let $Im(p) > 0$) be the two points at which the contour $D_{R,d}$ and the circle centered at 0 with radius $k+1/2$ intersect. Then $D_{R,d;k}$ is the union of the portion of $D_{R,d}$ inside the circle with reversed orientation, with the arc from $\bar{p}$ to $p$ (oriented counterclockwise). \\

The following proposition writes a generating function of $\mu_k$ into the Fredholm determinants form.
\begin{proposition}
\label{step-1-mellin-barnes}
Consider $\mu_k$ as in Equation \ref{new_mu_k} with closed contours $C_{\mathbb{A}}$ for $k = 1,2,\dots$. Then the following formal equality holds:
$$\sum_{k \ge 0} \mu_k \frac{\zeta^k}{k_q!} = det(I+K_{\zeta}^{1}),$$ where $K_{\zeta}^1:L^2(\mathbb{Z}_{>0} \times C_{\mathbb{A}}) \rightarrow L^2(\mathbb{Z}_{>0} \times C_{\mathbb{A}})$ is defined by its integral kernel $$K_{\zeta}^1(n_1, w_1; n_2, w_2)= \frac{(1-q)^{n_1} \zeta^{n_1} f(w_1) f(qw_1) \dots f(q^{n_1-1}w_1)}{q_{n_1}w_1 - w_2},$$
where the identity is formal. It also holds numerically with the following condition that
\begin{enumerate}
\item[(1)] for all $w, w' \in C_{\mathbb{A}}$ and $n \ge 1$, $|q^n w - w'|^{-1}$ is uniformly bounded above;
\item[(2)] $\exists M > 0$ constant such that for all $w \in C_{\mathbb{A}}$ and all $n \ge 0$, $|f(q^n w)| \le M$ and $|(1-q) \zeta| < M^{-1}$.
\end{enumerate}
\end{proposition}

We defer the proof of the proposition and state the immediate result continuing from Proposition \ref{step-1-mellin-barnes}.

\begin{proposition}
\label{step-2-mellin-barnes}
Assume $f(w) = g(w) / g(qw)$ for some function $g$. Then the following formal identity holds:
$$det(I+K_{\zeta}^1) = det(I+K_{\zeta}^2),$$ where $det(I+K_{\zeta}^1)$ is given in Proposition \ref{step-1-mellin-barnes} and $K_{\zeta}^2:L^2(C_{\mathbb{A}}) \rightarrow L^2(C_{\mathbb{A}})$ is given by its integration kernel $$K_{\zeta}^2(w,w') = \frac{1}{2 \pi i} \int_{C_{1,2,\dots}} \Gamma(-s) \Gamma(1+s) (-(1-q)\zeta)^s \frac{g(w)}{g(q^sw)} \frac{1}{q^sw - w'} ds.$$
The above identity also holds numerically given the condition that $det(I+K_{\zeta}^1)$ is convergent and that $C_{1,2,\dots}$ is chosen as $D_{R,d}$ with $d > 0$ and $R > 0$ such that $$ inf_{\substack{ {w, w' \in C_{\mathbb{A}}} \\ {k \in \mathbb{Z}_{>0}, s \in D_{R, d;k}} }} |q^sw - w'| > 0 \text{ and } sup_{\substack{ {w,w' \in C_{\mathbb{A}}} \\ {k \in \mathbb{Z}_{>0}, s \in D_{R,d;k}} }} \left| \frac{g(w)}{g(q^s w)} \right| < \infty.$$
\end{proposition}

\begin{proof}[Proof of Proposition \ref{step-1-mellin-barnes}]
Write $$I_{l(\lambda)}(\lambda; w; \zeta) = \frac{1}{(2 \pi i)^{l(\lambda)}} det\left[ \frac{1}{w_i q^{\lambda_i} - w_j} \right]_{i,j=1}^{l(\lambda)} \prod_{j=1}^{l(\lambda)} (1-q)^{\lambda_j} \zeta^{\lambda_j} f(w_j) f(qw_j) \dots f(q^{\lambda_j - 1} w_j).$$
Then for the $\mu_k$ given in Proposition \ref{mellin-barnes-transform}, we have
\begin{align*}
\mu_k \frac{\zeta^k}{k_q!} &= \sum_{\substack{ {\lambda \vdash k} \\ {\lambda = 1^{m_1} 2^{m_2} \dots} }} \frac{1}{m_1! m_2! \dots} \int \dots \int \prod_{j=1}^{l(\lambda)} I_{l(\lambda)}(\lambda; w; \zeta) dw_j \\
&= \sum_{\substack{ {\lambda \vdash k} \\ {\lambda = 1^{m_1} 2^{m_2} \dots} }} \frac{1}{(m_1 + m_2 + \dots)!} \frac{(m_1 + m_2 + \dots)!}{m_1! m_2! \dots} \int \dots \int \prod_{j=1}^{l(\lambda)} I_{l(\lambda)}(\lambda; w; \zeta) dw_j \\
&= \sum_{l(\lambda) \ge 0} \frac{1}{l(\lambda)!} \sum_{\substack{{\sum m_i = l(\lambda)} \\ {\sum im_i = k}}} \frac{(m_1 + m_2 + \dots)!}{m_1! m_2! \dots} \int \dots \int \prod_{j=1}^{l(\lambda)} I_{l(\lambda)}(\lambda; w; \zeta) dw_j,
\end{align*}
where all the contour integrals are with respect to the contour $C_{\mathbb{A}}$. 

Notice that the coefficient $\frac{(m_1+m_2+\dots)!}{m_1! m_2! \dots}$ is a multinomial coefficient. Therefore, the inner summation can be replaced by $$\sum_{\substack{{n = (n_1, \dots, n_{l(\lambda)})} \\ {\sum n_i = k}}} \int \dots \int \prod_{j=1}^{l(\lambda)} I_{l(\lambda)}(n; w; \zeta) dw_j.$$
We can replace $l(\lambda)$ simply by $L$ since we have got rid of the dependence on $\lambda$ which is now on $n$. Also, summing over all $k \ge 0$ will remove the restriction on $\sum n_i = k$. This gives us the following form
\begin{align*}
\sum_{k \ge 0} \mu_k \frac{\zeta^k}{k_q!} = &\sum_{L \ge 0} \frac{1}{L!} \sum_{n_1, \dots, n_L \in \mathbb{Z}_{>0}} \frac{1}{(2 \pi i)^{L}} \int \dots \int det\left[ \frac{1}{q^{n_i} w_i - w_j} \right]_{i,j=1}^{L} \\
&\times \prod_{j=1}^{L} (1-q)^{n_j} \zeta^{n_j} f(w_j) \dots f(q^{n_j-1} w_j) dw_j \numberthis \label{absolute-convergent-1}
\end{align*}
This is exactly the definition of $det(I+K_{1}^{\zeta})_{L(\mathbb{Z}_{>0} \times C_{\mathbb{A}})}$. This proves the formal equality of the two sides.

Next, we show the numerical equality also holds under the conditions given. For this, we only need to show that under the conditions, (\ref{absolute-convergent-1}) is absolutely convergent. By condition $(1)$, there exists a constant $B > 0$ such that $\frac{1}{q^{n_i} w_i - w_j} \le B$ for all $w_i, w_j \in C_{\mathbb{A}}$ and all $n_i \in \mathbb{Z}_{>0}$. Therefore, by Hadamard's bound, $$\left| det\left[ \frac{1}{q^{n_i} w_i - w_j} \right]_{i,j=1}^{L} \right| \le B^L L^{L/2}.$$
Moreover, by condition $(2)$, $$\left| \prod_{j=1}^{L} (1-q)^{n_j} \zeta^{n_j} f(w_j) \dots f(q^{n_j-1} w_j) \right| \le 1.$$ Therefore, we have the following inequality that 
$$\left| \int \dots \int  det\left[ \frac{1}{q^{n_i} w_i - w_j} \right]_{i,j=1}^{L} \prod_{j=1}^{L} (1-q)^{n_j} \zeta^{n_j} f(w_j) \dots f(q^{n_j-1} w_j) \frac{dw_j}{2 \pi i} \right| \le (BC)^L L^{L/2},$$
where $C$ is the length of the fixed contour $C_{\mathbb{A}}$. Summing over $L \ge 0$, we get that (\ref{absolute-convergent-1}) is uniformly bounded above by $$\sum_{L \ge 0} \frac{1}{L!}(BC)^L L^{L/2},$$ which converges finitely due to the $L!$ in the denominator. As a result, we have the numerical identity.
\end{proof}
\begin{proof}[Proof of Proposition \ref{step-2-mellin-barnes}]
We first show the formal identity. Recall a result that for $k \in \mathbb{Z}_{> 0}$, $$Res_{z = k} \Gamma(-z) \Gamma(1+z) = (-1)^{k+1}.$$ Therefore, we have that
\begin{align*}
K_{\zeta}^2(w,w') &= \frac{1}{2 \pi i} \int_{C_{1,2,\dots}} \Gamma(-s) \Gamma(1+s) (-(1-q)\zeta)^s \frac{g(w)}{g(q^sw)} \frac{1}{q^sw - w'} ds\\
&= \sum_{n \in \mathbb{Z}_{>0}} ((1-q) \zeta)^n \frac{g(w)}{g(q^nw)} \frac{1}{q^n w - w'}.
\end{align*}
and hence, by definition, the Fredholm determinants $det(I+K_{\zeta}^2)$ can be expanded as
$$1 + \sum_{L=1}^{\infty} \frac{1}{L!} \sum_{n_1, \dots, n_L \ge 1} det\left[ \frac{1}{q^{n_i} w_i - w_j} \right]_{i,j = 1}^{L} \prod_{j=1}^{L} ((1-q)\zeta)^{n_j} \frac{g(w)}{g(q^{n_j} w)} \frac{dw_j}{2 \pi i}.$$
This is exactly the same as (\ref{absolute-convergent-1}). We have thus proven the formal identity.

Next we show the numerical identity under the conditions given. This follows from the fact that the additional conditions ensure that the kernel $K_{\zeta}^2(w,w')$ absolutely converges so that $det(I+K_{\zeta}^2)$ is well defined numerically. This can bee seen from the fact that 
\begin{align*}
K_{\zeta}^2(w,w') &= \sum_{n \in \mathbb{Z}_{>0}} ((1-q) \zeta)^n \frac{g(w)}{g(q^nw)} \frac{1}{q^n w - w'}\\
&\le \sum_{n \in \mathbb{Z}_{>0}} M^{-n} B_1 B_2\\
&= B_1 B_2 \frac{1}{1-M},
\end{align*}
where $B_1, B_2$ is such that $\left| \frac{g(w)}{g(q^nw)} \right| \le B_1$ and $\left| \frac{1}{q^n w - w'} \right| \le B_2$ for all $n \ge 0$ and $w, w' \in C_{\mathbb{A}}$.
\end{proof}

\subsection{Application to q-TASEP}
In Section \ref{m-b-type-transformation} and \ref{transformation-to-fd}, we discussed a general manipulation of nested contour integrals of the form $\mu_k$ using the Mellin-Barnes type philosophy. Recall the result from Corollary \ref{nested-contour-corollary} that for step initial data q-TASEP and $\vec{n} \in W^k_{>0}$, 
\begin{align*}
& \mathbb{E} \left[ \prod_{j=1}^k q^{x_{n_j}+n_j} \right] = \\
& \quad \frac{(-1)^k q^{k(k-1)/2}}{(2 \pi i)^k} \times \int \dots \int \prod_{1 \le A < B \le k} \frac{z_A - z_B}{z_A - qz_B} \prod_{j=1}^k \left( \prod_{m=1}^{n_j} \frac{a_m}{a_m - z_j}\right) e^{(q-1)tz_j} \frac{dz_j}{z_j},
\end{align*}
where the integration contour for $z_A$ contains $\{qz_B\}_{B > A}$ and all $a_m's$ but not $0$. As remarked, if we were to take $$f(z) = \left( \prod_{m=1}^{n} \frac{a_m}{a_m - z} \right) e^{(q-1)tz},$$ then $\mathbb{E} \left[ \prod_{j=1}^k q^{x_{n_j}+n_j} \right] = \mu_k$. Further more, in order to apply Proposition \ref{step-2-mellin-barnes}, we need a function $g(w)$ such that $f(w) = \frac{g(w)}{g(qw)}$. In this case, we can choose $$g(w) = \prod_{m=1}^{n} \frac{1}{(w/a_m; q)_{\infty}} e^{-tw}.$$ It's easy to verify that the choice of $g(w)$ is valid. Therefore, applying the two propositions, i.e. Proposition \ref{step-1-mellin-barnes} and then Proposition \ref{step-2-mellin-barnes} to $\mu_k = \mathbb{E} \left[ \prod_{j=1}^k q^{x_{n_j}+n_j} \right]$, we get that for $\vec{n} \in W^k_{>0}$ and for all $t \ge 0$,
\begin{equation}
\label{m-b-application-to-qtasep-raw}
\sum_{k \ge 0} \mathbb{E} \left[ \prod_{j=1}^k q^{x_{n_j}(t)+n_j} \right] \frac{\zeta^k}{k_q!} = det(I+K^2_{\zeta})
\end{equation}
We state the result as a theorem. 
\begin{theorem}
Fix $0 < q < 1$ and $n \ge 1$. Consider q-TASEP with step initial data and jump rate parameters $a_i > 0$. Denote $\mathbb{A}$ to be the set of all $a_i$, $i = 1, \dots, n$, namely, $\mathbb{A} = \{a_i: i = 1, \dots, n\}$ and define $C_{\mathbb{A}}$ to be a closed contour which contains $\mathbb{A}$ and not $0$ such that $w \neq q^n w'$ for any $n \ge 1$ for all $w, w' \in C_{\mathbb{A}}$. Then for all $t \ge 0$ and $\zeta \in \mathbb{C} \setminus \mathbb{R}_+$, the following characterizes the distribution of $x_n(t)$:
\begin{equation}
\label{m-b-application-to-qtasep}
\mathbb{E} \left[ \frac{1}{(\zeta q^{x_n(t)+n}; q)_{\infty}} \right] = det(I+K_{\zeta}^{q-TASEP}),
\end{equation}
where $det(I+K_{\zeta}^{q-TASEP})$ is the Fredholm determinant of $K_{\zeta}^{q-TASEP}: L^2(C_{\mathbb{A}}) \rightarrow L^2(\mathbb{A})$. The operator $K_{\zeta}^{q-TASEP}$ is defined in terms of its integral kernel
$$K_{\zeta}^{q-TASEP}(w,w') = \frac{1}{2 \pi i} \int_{C_{1,2,\dots}} \Gamma(-s) \Gamma(1+s) (-\zeta)^s \frac{g(w)}{g(q^sw)} \frac{1}{q^sw - w'} ds.$$
With the additional conditions that
\begin{enumerate}
\item[(1)] for all $w, w' \in C_{\mathbb{A}}$ and $n \ge 1$, $|q^n w - w'|^{-1}$ is uniformly bounded above;
\item[(2)] $\exists M > 0$ constant such that for all $w \in C_{\mathbb{A}}$ and all $n \ge 0$, $|f(q^n w)| \le M$ and $|(1-q) \zeta| < M^{-1}$.
\item[(3)] $C_{1,2,\dots}$ is chosen as $D_{R,d}$ with $d > 0$ and $R > 0$ such that $$ inf_{\substack{ {w, w' \in C_{\mathbb{A}}} \\ {k \in \mathbb{Z}_{>0}, s \in D_{R, d;k}} }} |q^sw - w'| > 0 \text{ and } sup_{\substack{ {w,w' \in C_{\mathbb{A}}} \\ {k \in \mathbb{Z}_{>0}, s \in D_{R,d;k}} }} \left| \frac{g(w)}{g(q^s w)} \right| < \infty.$$
\end{enumerate}
Equation (\ref{m-b-application-to-qtasep}) also holds numerically.
\end{theorem}

\begin{remark}
It's remarked that from the results above, the probability that $\mathbb{P}(x_n(t) = k)$ can be uniquely determined.
\end{remark}

\begin{proof}
We continue from the result as stated in Equation (\ref{m-b-application-to-qtasep-raw}). If we take $\vec{n} = (n,n,\dots,n)$, then 
\begin{align*}
\sum_{k \ge 0} \mathbb{E} \left[ \prod_{j=1}^k q^{x_{n_j}(t)+n_j} \right] \frac{\zeta^k}{k_q!} &= \mathbb{E} \left[ \sum_{k \ge 0} (\zeta q^{x_n(t) + n})^k \frac{1}{k_q!} \right]\\
&= \mathbb{E} \left[ \sum_{k \ge 0} \frac{[(1-q) \zeta q^{x_n(t) + n}]^k}{(q;q)_k} \right]\\
&= \mathbb{E} \left[ \frac{1}{( (1-q) \zeta q^{x_n(t) + n} ;q)_{\infty}} \right] \text{ (by the q-Binomial theorem) }
\end{align*}
Therefore, Equation (\ref{m-b-application-to-qtasep-raw}) now becomes $$\mathbb{E} \left[ \frac{1}{( (1-q) \zeta q^{x_n(t) + n} ;q)_{\infty}} \right] = det(I+K^2_{\zeta}).$$
Absorbing the $(1-q)$ factor into $\zeta$, we get the formal identity that $$\mathbb{E} \left[ \frac{1}{(\zeta q^{x_n(t)+n}; q)_{\infty}} \right] = det(I+K_{\zeta}^{q-TASEP}),$$ where the integral kernel of $K^{q-TASE}_{\zeta} (w,w')$ is defined by the integral kernel of $K^2_{\zeta}(w,w')$ with $\zeta$ replaced by $(1-q)\zeta$. That is, $$K_{\zeta}^{q-TASEP} (w, w') = \frac{1}{2 \pi i} \int_{C_{1,2, \dots}} \Gamma(-s) \Gamma(1+s) (-\zeta)^s \frac{g(w)}{g(q^s w)} \frac{1}{q^s w - w'}ds.$$
Numerical identity follows from the proof of Proposition \ref{step-1-mellin-barnes} and \ref{step-2-mellin-barnes}.
\end{proof}